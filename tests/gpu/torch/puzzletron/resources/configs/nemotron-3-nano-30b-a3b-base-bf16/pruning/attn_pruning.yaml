defaults:
  - pruning_defaults

activations_log_dir: ${puzzle_dir}/pruning/pruning_scores/attn/${pruning.experiment_id}
pruning_mixin:
  _target_: modelopt.torch.puzzletron.pruning.kv_heads_pruning_mixin.KVHeadsPruningMixIn
  layer_descriptor:
    _target_: modelopt.torch.puzzletron.anymodel.models.llama.llama_model_descriptor.LlamaKVHeadsLayerDescriptor

hook_class: ${get_object:modelopt.torch.nas.plugins.megatron_hooks.base_hooks.IndependentKvHeadContributionHook}
activation_hooks_kwargs:    # Additional kwargs to pass to the hook init
  optimize_for: memory    # IndependentKvHeadContributionHook implementation that consumes less memory

num_key_value_heads_list: [4, 2, 1]
gqa_init_mode: "PruneKVHeads"
